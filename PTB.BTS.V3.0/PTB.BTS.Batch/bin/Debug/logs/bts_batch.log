2022-03-31 17:30:44,625 [8] INFO - Invalid parameter : .
2022-03-31 17:33:22,212 [9] INFO - Batch B01 started.
2022-03-31 17:33:22,235 [9] INFO - Generating Report
2022-03-31 17:33:22,258 [9] ERROR - System.Data.SqlClient.SqlException: Cannot open database "BTSDB_UAT" requested by the login. The login failed.
Login failed for user 'sa'.
   at DataAccess.CommonDB.TableAccess.internalExecuteDataReader(String strSQL, CommandType commandType) in D:\_Projects\ptb_bts\SS01_ReportCarAgreement(Company)\PTB.BTS.V3.0\DataAccess\CommonDB\TableAccess.cs:line 75
   at DataAccess.CommonDB.TableAccess.ExecuteDataReader(String strSQL) in D:\_Projects\ptb_bts\SS01_ReportCarAgreement(Company)\PTB.BTS.V3.0\DataAccess\CommonDB\TableAccess.cs:line 310
   at DataAccess.PiDB.CompanyDB.fillCompany(Company& value, String sql) in D:\_Projects\ptb_bts\SS01_ReportCarAgreement(Company)\PTB.BTS.V3.0\DataAccess\PiDB\CompanyDB.cs:line 336
   at DataAccess.PiDB.CompanyDB.FillCompany(Company& value) in D:\_Projects\ptb_bts\SS01_ReportCarAgreement(Company)\PTB.BTS.V3.0\DataAccess\PiDB\CompanyDB.cs:line 398
   at PTB.BTS.PI.Flow.CompanyFlow.FillCompany(Company& value) in D:\_Projects\ptb_bts\SS01_ReportCarAgreement(Company)\PTB.BTS.V3.0\Flow\PiFlow\CompanyFlow.cs:line 28
   at Facade.PiFacade.CommonPIFacadeBase.GetCompany() in D:\_Projects\ptb_bts\SS01_ReportCarAgreement(Company)\PTB.BTS.V3.0\Facade\PiFacade\CommonPIFacadeBase.cs:line 46
   at Facade.ContractFacade.ContractFacadeBase..ctor() in D:\_Projects\ptb_bts\SS01_ReportCarAgreement(Company)\PTB.BTS.V3.0\Facade\ContractFacade\ContractFacadeBase.cs:line 148
   at PTB.BTS.Batch.GenerateExpectedIncomeReport.GenerateReport() in D:\_Projects\ptb_bts\SS01_ReportCarAgreement(Company)\PTB.BTS.V3.0\PTB.BTS.Batch\GenerateExpectedIncomeReport.cs:line 48
   at PTB.BTS.Batch.GenerateExpectedIncomeReport.Execute(Object[] args) in D:\_Projects\ptb_bts\SS01_ReportCarAgreement(Company)\PTB.BTS.V3.0\PTB.BTS.Batch\GenerateExpectedIncomeReport.cs:line 37
2022-03-31 17:33:22,274 [9] INFO - Batch B01 completed.
2022-03-31 17:35:11,680 [9] INFO - Batch B01 started.
2022-03-31 17:35:11,702 [9] INFO - Generating Report
2022-03-31 17:36:34,870 [9] INFO - Batch B01 started.
2022-03-31 17:36:34,892 [9] INFO - Generating Report
2022-03-31 17:36:57,447 [9] ERROR - System.Data.SqlClient.SqlException: Cannot open database "BTSDB_UAT" requested by the login. The login failed.
Login failed for user 'sa'.
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj)
   at System.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
   at System.Data.SqlClient.SqlInternalConnectionTds.CompleteLogin(Boolean enlistOK)
   at System.Data.SqlClient.SqlInternalConnectionTds.AttemptOneLogin(ServerInfo serverInfo, String newPassword, Boolean ignoreSniOpenTimeout, Int64 timerExpire, SqlConnection owningObject, Boolean withFailover)
   at System.Data.SqlClient.SqlInternalConnectionTds.LoginNoFailover(String host, String newPassword, Boolean redirectedUserInstance, SqlConnection owningObject, SqlConnectionString connectionOptions, Int64 timerStart)
   at System.Data.SqlClient.SqlInternalConnectionTds.OpenLoginEnlist(SqlConnection owningObject, SqlConnectionString connectionOptions, String newPassword, Boolean redirectedUserInstance)
   at System.Data.SqlClient.SqlInternalConnectionTds..ctor(DbConnectionPoolIdentity identity, SqlConnectionString connectionOptions, Object providerInfo, String newPassword, SqlConnection owningObject, Boolean redirectedUserInstance)
   at System.Data.SqlClient.SqlConnectionFactory.CreateConnection(DbConnectionOptions options, Object poolGroupProviderInfo, DbConnectionPool pool, DbConnection owningConnection)
   at System.Data.ProviderBase.DbConnectionFactory.CreatePooledConnection(DbConnection owningConnection, DbConnectionPool pool, DbConnectionOptions options)
   at System.Data.ProviderBase.DbConnectionPool.CreateObject(DbConnection owningObject)
   at System.Data.ProviderBase.DbConnectionPool.UserCreateRequest(DbConnection owningObject)
   at System.Data.ProviderBase.DbConnectionPool.GetConnection(DbConnection owningObject)
   at System.Data.ProviderBase.DbConnectionFactory.GetConnection(DbConnection owningConnection)
   at System.Data.ProviderBase.DbConnectionClosed.OpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory)
   at System.Data.SqlClient.SqlConnection.Open()
   at System.Data.Common.DbDataAdapter.QuietOpen(IDbConnection connection, ConnectionState& originalState)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at PTB.BTS.Batch.GenerateExpectedIncomeReport.GenerateReport() in D:\_Projects\ptb_bts\SS01_ReportCarAgreement(Company)\PTB.BTS.V3.0\PTB.BTS.Batch\GenerateExpectedIncomeReport.cs:line 57
   at PTB.BTS.Batch.GenerateExpectedIncomeReport.Execute(Object[] args) in D:\_Projects\ptb_bts\SS01_ReportCarAgreement(Company)\PTB.BTS.V3.0\PTB.BTS.Batch\GenerateExpectedIncomeReport.cs:line 37
2022-03-31 17:36:57,455 [9] INFO - Batch B01 completed.
2022-03-31 17:45:43,572 [8] INFO - Batch B01 started.
2022-03-31 17:45:43,595 [8] INFO - Generating Report
2022-03-31 17:46:42,742 [9] INFO - Batch B01 started.
2022-03-31 17:46:42,764 [9] INFO - Generating Report
2022-03-31 17:47:10,399 [9] INFO - Filling excel.
2022-03-31 17:47:23,527 [9] ERROR - System.IO.DirectoryNotFoundException: Could not find a part of the path 'E:\BTS\BTSBatch\Template\B01_ExpectedIncomeReport.xlsx'.
   at System.IO.__Error.WinIOError(Int32 errorCode, String maybeFullPath)
   at System.IO.FileStream.Init(String path, FileMode mode, FileAccess access, Int32 rights, Boolean useRights, FileShare share, Int32 bufferSize, FileOptions options, SECURITY_ATTRIBUTES secAttrs, String msgPath, Boolean bFromProxy)
   at System.IO.FileStream..ctor(String path, FileMode mode, FileAccess access, FileShare share, Int32 bufferSize, FileOptions options, String msgPath, Boolean bFromProxy)
   at System.IO.FileStream..ctor(String path, FileMode mode, FileAccess access, FileShare share, Int32 bufferSize, Boolean useAsync)
   at MS.Internal.IO.Zip.ZipArchive.OpenOnFile(String path, FileMode mode, FileAccess access, FileShare share, Boolean streaming)
   at System.IO.Packaging.ZipPackage..ctor(String path, FileMode mode, FileAccess access, FileShare share, Boolean streaming)
   at System.IO.Packaging.Package.Open(String path, FileMode packageMode, FileAccess packageAccess, FileShare packageShare, Boolean streaming)
   at System.IO.Packaging.Package.Open(String path, FileMode packageMode, FileAccess packageAccess, FileShare packageShare)
   at DocumentFormat.OpenXml.Packaging.OpenXmlPackage.OpenCore(String path, Boolean readWriteMode)
   at DocumentFormat.OpenXml.Packaging.SpreadsheetDocument.Open(String path, Boolean isEditable, OpenSettings openSettings)
   at ClosedXML.Excel.XLWorkbook.LoadSheets(String fileName)
   at ClosedXML.Excel.XLWorkbook.Load(String file)
   at ClosedXML.Excel.XLWorkbook..ctor(String file, XLEventTracking eventTracking)
   at ClosedXML.Excel.XLWorkbook..ctor(String file)
   at PTB.BTS.Batch.GenerateExpectedIncomeReport.FillExcel(DataTable dt) in D:\_Projects\ptb_bts\SS01_ReportCarAgreement(Company)\PTB.BTS.V3.0\PTB.BTS.Batch\GenerateExpectedIncomeReport.cs:line 66
   at PTB.BTS.Batch.GenerateExpectedIncomeReport.GenerateReport() in D:\_Projects\ptb_bts\SS01_ReportCarAgreement(Company)\PTB.BTS.V3.0\PTB.BTS.Batch\GenerateExpectedIncomeReport.cs:line 58
   at PTB.BTS.Batch.GenerateExpectedIncomeReport.Execute(Object[] args) in D:\_Projects\ptb_bts\SS01_ReportCarAgreement(Company)\PTB.BTS.V3.0\PTB.BTS.Batch\GenerateExpectedIncomeReport.cs:line 37
2022-03-31 17:47:23,599 [9] INFO - Batch B01 completed.
2022-03-31 17:47:33,841 [9] INFO - Batch B01 started.
2022-03-31 17:47:33,863 [9] INFO - Generating Report
2022-03-31 17:47:34,535 [9] INFO - Filling excel.
2022-03-31 17:47:34,688 [9] ERROR - System.IO.DirectoryNotFoundException: Could not find a part of the path 'E:\BTS\BTSBatch\Template\B01_ExpectedIncomeReport.xlsx'.
   at System.IO.__Error.WinIOError(Int32 errorCode, String maybeFullPath)
   at System.IO.FileStream.Init(String path, FileMode mode, FileAccess access, Int32 rights, Boolean useRights, FileShare share, Int32 bufferSize, FileOptions options, SECURITY_ATTRIBUTES secAttrs, String msgPath, Boolean bFromProxy)
   at System.IO.FileStream..ctor(String path, FileMode mode, FileAccess access, FileShare share, Int32 bufferSize, FileOptions options, String msgPath, Boolean bFromProxy)
   at System.IO.FileStream..ctor(String path, FileMode mode, FileAccess access, FileShare share, Int32 bufferSize, Boolean useAsync)
   at MS.Internal.IO.Zip.ZipArchive.OpenOnFile(String path, FileMode mode, FileAccess access, FileShare share, Boolean streaming)
   at System.IO.Packaging.ZipPackage..ctor(String path, FileMode mode, FileAccess access, FileShare share, Boolean streaming)
   at System.IO.Packaging.Package.Open(String path, FileMode packageMode, FileAccess packageAccess, FileShare packageShare, Boolean streaming)
   at System.IO.Packaging.Package.Open(String path, FileMode packageMode, FileAccess packageAccess, FileShare packageShare)
   at DocumentFormat.OpenXml.Packaging.OpenXmlPackage.OpenCore(String path, Boolean readWriteMode)
   at DocumentFormat.OpenXml.Packaging.SpreadsheetDocument.Open(String path, Boolean isEditable, OpenSettings openSettings)
   at ClosedXML.Excel.XLWorkbook.LoadSheets(String fileName)
   at ClosedXML.Excel.XLWorkbook.Load(String file)
   at ClosedXML.Excel.XLWorkbook..ctor(String file, XLEventTracking eventTracking)
   at ClosedXML.Excel.XLWorkbook..ctor(String file)
   at PTB.BTS.Batch.GenerateExpectedIncomeReport.FillExcel(DataTable dt) in D:\_Projects\ptb_bts\SS01_ReportCarAgreement(Company)\PTB.BTS.V3.0\PTB.BTS.Batch\GenerateExpectedIncomeReport.cs:line 66
   at PTB.BTS.Batch.GenerateExpectedIncomeReport.GenerateReport() in D:\_Projects\ptb_bts\SS01_ReportCarAgreement(Company)\PTB.BTS.V3.0\PTB.BTS.Batch\GenerateExpectedIncomeReport.cs:line 58
   at PTB.BTS.Batch.GenerateExpectedIncomeReport.Execute(Object[] args) in D:\_Projects\ptb_bts\SS01_ReportCarAgreement(Company)\PTB.BTS.V3.0\PTB.BTS.Batch\GenerateExpectedIncomeReport.cs:line 37
2022-03-31 17:47:34,702 [9] INFO - Batch B01 completed.
2022-03-31 17:47:48,006 [9] INFO - Batch B01 started.
2022-03-31 17:47:48,028 [9] INFO - Generating Report
2022-03-31 17:47:57,807 [9] INFO - Filling excel.
2022-03-31 18:07:24,569 [9] INFO - Batch B01 started.
2022-03-31 18:07:24,593 [9] INFO - Generating Report
2022-03-31 18:07:25,234 [9] INFO - Filling excel.
2022-03-31 18:07:25,400 [9] ERROR - System.IO.DirectoryNotFoundException: Could not find a part of the path 'E:\BTS\BTSBatch\Template\B01_ExpectedIncomeReport.xlsx'.
   at System.IO.__Error.WinIOError(Int32 errorCode, String maybeFullPath)
   at System.IO.FileStream.Init(String path, FileMode mode, FileAccess access, Int32 rights, Boolean useRights, FileShare share, Int32 bufferSize, FileOptions options, SECURITY_ATTRIBUTES secAttrs, String msgPath, Boolean bFromProxy)
   at System.IO.FileStream..ctor(String path, FileMode mode, FileAccess access, FileShare share, Int32 bufferSize, FileOptions options, String msgPath, Boolean bFromProxy)
   at System.IO.FileStream..ctor(String path, FileMode mode, FileAccess access, FileShare share, Int32 bufferSize, Boolean useAsync)
   at MS.Internal.IO.Zip.ZipArchive.OpenOnFile(String path, FileMode mode, FileAccess access, FileShare share, Boolean streaming)
   at System.IO.Packaging.ZipPackage..ctor(String path, FileMode mode, FileAccess access, FileShare share, Boolean streaming)
   at System.IO.Packaging.Package.Open(String path, FileMode packageMode, FileAccess packageAccess, FileShare packageShare, Boolean streaming)
   at System.IO.Packaging.Package.Open(String path, FileMode packageMode, FileAccess packageAccess, FileShare packageShare)
   at DocumentFormat.OpenXml.Packaging.OpenXmlPackage.OpenCore(String path, Boolean readWriteMode)
   at DocumentFormat.OpenXml.Packaging.SpreadsheetDocument.Open(String path, Boolean isEditable, OpenSettings openSettings)
   at ClosedXML.Excel.XLWorkbook.LoadSheets(String fileName)
   at ClosedXML.Excel.XLWorkbook.Load(String file)
   at ClosedXML.Excel.XLWorkbook..ctor(String file, XLEventTracking eventTracking)
   at ClosedXML.Excel.XLWorkbook..ctor(String file)
   at PTB.BTS.Batch.GenerateExpectedIncomeReport.FillExcel(DataTable dt) in D:\_Projects\ptb_bts\SS01_ReportCarAgreement(Company)\PTB.BTS.V3.0\PTB.BTS.Batch\GenerateExpectedIncomeReport.cs:line 66
   at PTB.BTS.Batch.GenerateExpectedIncomeReport.GenerateReport() in D:\_Projects\ptb_bts\SS01_ReportCarAgreement(Company)\PTB.BTS.V3.0\PTB.BTS.Batch\GenerateExpectedIncomeReport.cs:line 58
   at PTB.BTS.Batch.GenerateExpectedIncomeReport.Execute(Object[] args) in D:\_Projects\ptb_bts\SS01_ReportCarAgreement(Company)\PTB.BTS.V3.0\PTB.BTS.Batch\GenerateExpectedIncomeReport.cs:line 37
2022-03-31 18:07:25,428 [9] INFO - Batch B01 completed.
2022-03-31 18:08:12,839 [9] INFO - Batch B01 started.
2022-03-31 18:08:12,861 [9] INFO - Generating Report
2022-03-31 18:08:13,476 [9] INFO - Filling excel.
2022-04-08 11:34:50,778 [9] INFO - Batch B01 started.
2022-04-08 11:34:50,802 [9] INFO - Generating Report
2022-04-08 11:34:50,895 [9] ERROR - System.Data.SqlClient.SqlException: Login failed for user 'sa'.
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj)
   at System.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
   at System.Data.SqlClient.SqlInternalConnectionTds.CompleteLogin(Boolean enlistOK)
   at System.Data.SqlClient.SqlInternalConnectionTds.AttemptOneLogin(ServerInfo serverInfo, String newPassword, Boolean ignoreSniOpenTimeout, Int64 timerExpire, SqlConnection owningObject, Boolean withFailover)
   at System.Data.SqlClient.SqlInternalConnectionTds.LoginNoFailover(String host, String newPassword, Boolean redirectedUserInstance, SqlConnection owningObject, SqlConnectionString connectionOptions, Int64 timerStart)
   at System.Data.SqlClient.SqlInternalConnectionTds.OpenLoginEnlist(SqlConnection owningObject, SqlConnectionString connectionOptions, String newPassword, Boolean redirectedUserInstance)
   at System.Data.SqlClient.SqlInternalConnectionTds..ctor(DbConnectionPoolIdentity identity, SqlConnectionString connectionOptions, Object providerInfo, String newPassword, SqlConnection owningObject, Boolean redirectedUserInstance)
   at System.Data.SqlClient.SqlConnectionFactory.CreateConnection(DbConnectionOptions options, Object poolGroupProviderInfo, DbConnectionPool pool, DbConnection owningConnection)
   at System.Data.ProviderBase.DbConnectionFactory.CreatePooledConnection(DbConnection owningConnection, DbConnectionPool pool, DbConnectionOptions options)
   at System.Data.ProviderBase.DbConnectionPool.CreateObject(DbConnection owningObject)
   at System.Data.ProviderBase.DbConnectionPool.UserCreateRequest(DbConnection owningObject)
   at System.Data.ProviderBase.DbConnectionPool.GetConnection(DbConnection owningObject)
   at System.Data.ProviderBase.DbConnectionFactory.GetConnection(DbConnection owningConnection)
   at System.Data.ProviderBase.DbConnectionClosed.OpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory)
   at System.Data.SqlClient.SqlConnection.Open()
   at System.Data.Common.DbDataAdapter.QuietOpen(IDbConnection connection, ConnectionState& originalState)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at PTB.BTS.Batch.GenerateExpectedIncomeReport.GenerateReport() in D:\_Projects\ptb_bts\SS01_ReportCarAgreement(Company)\PTB.BTS.V3.0\PTB.BTS.Batch\GenerateExpectedIncomeReport.cs:line 57
   at PTB.BTS.Batch.GenerateExpectedIncomeReport.Execute(Object[] args) in D:\_Projects\ptb_bts\SS01_ReportCarAgreement(Company)\PTB.BTS.V3.0\PTB.BTS.Batch\GenerateExpectedIncomeReport.cs:line 37
2022-04-08 11:34:50,901 [9] INFO - Batch B01 completed.
2022-04-08 11:36:27,239 [9] INFO - Batch B01 started.
2022-04-08 11:36:27,261 [9] INFO - Generating Report
2022-04-08 11:36:28,205 [9] INFO - Filling excel.
2022-04-08 11:36:29,970 [9] INFO - Batch B01 completed.
2022-04-08 11:38:26,247 [9] INFO - Batch B01 started.
2022-04-08 11:38:26,268 [9] INFO - Generating Report
2022-04-08 11:38:26,747 [9] INFO - Filling excel.
2022-04-08 11:38:28,385 [9] INFO - Batch B01 completed.
2022-04-08 11:45:28,860 [1] INFO - Batch B01 started.
2022-04-08 11:45:28,889 [1] INFO - Generating Report
2022-04-08 11:45:29,734 [1] INFO - Filling excel.
2022-04-08 11:45:31,624 [1] INFO - Batch B01 completed.
2022-04-08 11:53:24,902 [1] INFO - Batch B01 started.
2022-04-08 11:53:24,931 [1] INFO - Generating Report
2022-04-08 11:53:25,796 [1] INFO - Filling excel.
2022-04-08 11:53:27,790 [1] INFO - Batch B01 completed.
2022-04-08 13:02:23,469 [1] INFO - Batch B01 started.
2022-04-08 13:02:23,501 [1] INFO - Generating Report
2022-04-08 13:02:24,266 [1] INFO - Filling excel.
2022-04-08 13:02:26,566 [1] INFO - Batch B01 completed.
2022-04-08 13:17:09,732 [9] INFO - Batch B01 started.
2022-04-08 13:17:09,764 [9] INFO - Generating Report
2022-04-08 13:17:10,306 [9] INFO - Filling excel.
2022-04-08 13:17:32,683 [9] ERROR - System.IO.IOException: The process cannot access the file 'D:\BTS\BTSBatch\TempFolder\Expected_Income_Report_20220408.xlsx' because it is being used by another process.
   at System.IO.__Error.WinIOError(Int32 errorCode, String maybeFullPath)
   at System.IO.File.InternalCopy(String sourceFileName, String destFileName, Boolean overwrite)
   at System.IO.File.Copy(String sourceFileName, String destFileName, Boolean overwrite)
   at ClosedXML.Excel.XLWorkbook.SaveAs(String file)
   at PTB.BTS.Batch.GenerateExpectedIncomeReport.FillExcel(DataTable dt) in D:\_Projects\ptb_bts\SS01_ReportCarAgreement(Company)\PTB.BTS.V3.0\PTB.BTS.Batch\GenerateExpectedIncomeReport.cs:line 214
   at PTB.BTS.Batch.GenerateExpectedIncomeReport.GenerateReport() in D:\_Projects\ptb_bts\SS01_ReportCarAgreement(Company)\PTB.BTS.V3.0\PTB.BTS.Batch\GenerateExpectedIncomeReport.cs:line 60
   at PTB.BTS.Batch.GenerateExpectedIncomeReport.Execute(Object[] args) in D:\_Projects\ptb_bts\SS01_ReportCarAgreement(Company)\PTB.BTS.V3.0\PTB.BTS.Batch\GenerateExpectedIncomeReport.cs:line 39
2022-04-08 13:17:32,761 [9] INFO - Batch B01 completed.
2022-04-08 13:20:06,621 [1] INFO - Batch B01 started.
2022-04-08 13:20:06,668 [1] INFO - Generating Report
2022-04-08 13:20:07,490 [1] INFO - Filling excel.
2022-04-08 13:20:10,265 [1] INFO - Batch B01 completed.
